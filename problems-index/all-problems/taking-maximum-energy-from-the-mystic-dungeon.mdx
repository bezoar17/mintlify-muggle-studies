---
title: 'ðŸ§€ Taking Maximum Energy From the Mystic Dungeon'
description: '[leetcode link](https://leetcode.com/problems/taking-maximum-energy-from-the-mystic-dungeon/description/)'
mode: 'wide'
---
<Tabs>
  <Tab title="Question" icon="circle-question" iconType="regular">
    <Card>
      <p>In a mystic dungeon, <code>n</code> magicians are standing in a line. Each magician has an attribute that gives you energy. Some magicians can give you negative energy, which means taking energy from you.</p>  <p>You have been cursed in such a way that after absorbing energy from magician <code>i</code>, you will be instantly transported to magician <code>(i + k)</code>. This process will be repeated until you reach the magician where <code>(i + k)</code> does not exist.</p>  <p>In other words, you will choose a starting point and then teleport with <code>k</code> jumps until you reach the end of the magicians&#39; sequence, <strong>absorbing all the energy</strong> during the journey.</p>  <p>You are given an array <code>energy</code> and an integer <code>k</code>. Return the <strong>maximum</strong> possible energy you can gain.</p>  <p><strong>Note</strong> that when you are reach a magician, you <em>must</em> take energy from them, whether it is negative or positive energy.</p>   <p><strong class="example">Example 1:</strong></p>  <div class="example-block" style="     border-color: var(--border-tertiary);     border-left-width: 2px;     color: var(--text-secondary);     font-size: .875rem;     margin-bottom: 1rem;     margin-top: 1rem;     overflow: visible;     padding-left: 1rem; "> <p><strong>Input:</strong> <span class="example-io" style="     font-family: Menlo,sans-serif;     font-size: 0.85rem; "> energy = [5,2,-10,-5,1], k = 3</span></p>  <p><br/> <strong>Output:</strong><span class="example-io" style="     font-family: Menlo,sans-serif;     font-size: 0.85rem; "> 3</span></p>  <p><br/> <strong>Explanation:</strong> We can gain a total energy of 3 by starting from magician 1 absorbing 2 + 1 = 3.</p> </div>  <p><strong class="example">Example 2:</strong></p>  <div class="example-block" style="     border-color: var(--border-tertiary);     border-left-width: 2px;     color: var(--text-secondary);     font-size: .875rem;     margin-bottom: 1rem;     margin-top: 1rem;     overflow: visible;     padding-left: 1rem; "> <p><strong>Input:</strong><span class="example-io" style="     font-family: Menlo,sans-serif;     font-size: 0.85rem; "> energy = [-2,-3,-1], k = 2</span></p>  <p><br/> <strong>Output:</strong><span class="example-io" style="     font-family: Menlo,sans-serif;     font-size: 0.85rem; "> -1</span></p>  <p><br/> <strong>Explanation:</strong> We can gain a total energy of -1 by starting from magician 2.</p> </div>   <p><strong>Constraints:</strong></p>  <ul>  <li><code>1 &lt;= energy.length &lt;= 10<sup>5</sup></code></li>  <li><code>-1000 &lt;= energy[i] &lt;= 1000</code></li>  <li><code>1 &lt;= k &lt;= energy.length - 1</code></li> </ul>   â€‹â€‹â€‹â€‹â€‹â€‹
    </Card>
  </Tab>
  <Tab title="Solution" icon="lightbulb" iconType="regular" >
    <Card>
      Path with k jumps, will repeat after k elements(with lesser stops, 1,3,5 will become 3,5  if k =2). These paths can be represented by mod k. Once you start at i, all elements to the right on that path you have to take. So, energy is suffix of nodes in this path including i. We maintain suffix-sum for each mod/path. And while suffix sum is calculated, suppose for [1,2,3,0], suffix sum starts from 0 -&gt; 3-&gt;5-&gt;6. All these distinct values represent different starting points for the same path. So, by generating suffix sum for mod paths, all calculated values represent all starting point and paths, so we just keep track of max for these calculations

This can easily be done by dp[i]=energy[i]+dp[i+k], and start from right. Take max of dp.
    </Card>
  <Expandable title="code">
    <CodeGroup dropdown>
```ruby title="Taking Maximum Energy From the Mystic Dungeon" lines
# @param {Integer[]} energy
# @param {Integer} k
# @return {Integer}
def maximum_energy(energy, k)
  n = energy.size
  dp = Array.new(n,0)
  (n-1).downto(0).each { |i| dp[i] = energy[i] + (i+k<n ?  dp[i+k]:0) }
  dp.max
end
```
    </CodeGroup>
  </Expandable>
  </Tab>
</Tabs>