---
title: 'ðŸ§€ Shift Distance Between Two Strings'
description: '[leetcode link](https://leetcode.com/problems/shift-distance-between-two-strings/description/)'
mode: 'wide'
---
<Tabs>
  <Tab title="Question" icon="circle-question" iconType="regular">
    <Card>
      <p>You are given two strings <code>s</code> and <code>t</code> of the same length, and two integer arrays <code>nextCost</code> and <code>previousCost</code>.</p>  <p>In one operation, you can pick any index <code>i</code> of <code>s</code>, and perform <strong>either one</strong> of the following actions:</p>  <ul>  <li>Shift <code>s[i]</code> to the next letter in the alphabet. If <code>s[i] == &#39;z&#39;</code>, you should replace it with <code>&#39;a&#39;</code>. This operation costs <code>nextCost[j]</code> where <code>j</code> is the index of <code>s[i]</code> in the alphabet.</li>  <li>Shift <code>s[i]</code> to the previous letter in the alphabet. If <code>s[i] == &#39;a&#39;</code>, you should replace it with <code>&#39;z&#39;</code>. This operation costs <code>previousCost[j]</code> where <code>j</code> is the index of <code>s[i]</code> in the alphabet.</li> </ul>  <p>The <strong>shift distance</strong> is the <strong>minimum</strong> total cost of operations required to transform <code>s</code> into <code>t</code>.</p>  <p>Return the <strong>shift distance</strong> from <code>s</code> to <code>t</code>.</p>   <p><strong class="example">Example 1:</strong></p>  <div class="example-block"> <p><strong>Input:</strong> <span class="example-io">s = &quot;abab&quot;, t = &quot;baba&quot;, nextCost = [100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], previousCost = [1,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]</span></p>  <p><br/> <strong>Output:</strong> <span class="example-io">2</span></p>  <p><br/> <strong>Explanation:</strong></p>  <ul>  <li>We choose index <code>i = 0</code> and shift <code>s[0]</code> 25 times to the previous character for a total cost of 1.</li>  <li>We choose index <code>i = 1</code> and shift <code>s[1]</code> 25 times to the next character for a total cost of 0.</li>  <li>We choose index <code>i = 2</code> and shift <code>s[2]</code> 25 times to the previous character for a total cost of 1.</li>  <li>We choose index <code>i = 3</code> and shift <code>s[3]</code> 25 times to the next character for a total cost of 0.</li> </ul> </div>  <p><strong class="example">Example 2:</strong></p>  <div class="example-block"> <p><strong>Input:</strong> <span class="example-io">s = &quot;leet&quot;, t = &quot;code&quot;, nextCost = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1], previousCost = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]</span></p>  <p><br/> <strong>Output:</strong> <span class="example-io">31</span></p>  <p><br/> <strong>Explanation:</strong></p>  <ul>  <li>We choose index <code>i = 0</code> and shift <code>s[0]</code> 9 times to the previous character for a total cost of 9.</li>  <li>We choose index <code>i = 1</code> and shift <code>s[1]</code> 10 times to the next character for a total cost of 10.</li>  <li>We choose index <code>i = 2</code> and shift <code>s[2]</code> 1 time to the previous character for a total cost of 1.</li>  <li>We choose index <code>i = 3</code> and shift <code>s[3]</code> 11 times to the next character for a total cost of 11.</li> </ul> </div>   <p><strong>Constraints:</strong></p>  <ul>  <li><code>1 &lt;= s.length == t.length &lt;= 10<sup>5</sup></code></li>  <li><code>s</code> and <code>t</code> consist only of lowercase English letters.</li>  <li><code>nextCost.length == previousCost.length == 26</code></li>  <li><code>0 &lt;= nextCost[i], previousCost[i] &lt;= 10<sup>9</sup></code></li> </ul> 
    </Card>
  </Tab>
  <Tab title="Solution" icon="lightbulb" iconType="regular" >
    <Card>
      For an pair of chars (i,j) you can go in 2 directions, right or left. Calculate the minimum for both options for all pairs.
Then just sum it up for all strings.
    </Card>
  <Expandable title="code">
    <CodeGroup dropdown>
```ruby title="Shift Distance Between Two Strings" lines
# @param {String} s
# @param {String} t
# @param {Integer[]} next_cost
# @param {Integer[]} previous_cost
# @return {Integer}
class PseudoSumSegTree
  def initialize(arr)
    @n = arr.size # size of the source array
    # query can have r till n, so sum of all elements is at prefix[n]
    @prefix_sum_arr = (1..@n).reduce([0]) {|res, i| res << res.last + arr[i-1]; res } # sum till i-1
  end
  
  # [l,r)
  def query(l,r)
    @prefix_sum_arr[r] - @prefix_sum_arr[l]
  end
end

def shift_distance(s, t, next_cost, previous_cost)
  # 1 shift is 1 op, previous or next; s->t; one way
  ch_idx_h = ('a'..'z').each_with_index.to_h
  ch_transformation_cost = Array.new(26) { Array.new(26,0) }

  next_seg = PseudoSumSegTree.new(next_cost); next_sum = next_cost.sum;
  prev_seg = PseudoSumSegTree.new(previous_cost); prev_sum = previous_cost.sum;
  
  (0...26).each do |i|
    (0...26).each do |j|
      next if i==j
      if j>i
        next_val = next_seg.query(i,j)
        prev_val = prev_sum - prev_seg.query(i+1,j+1)
      else
        next_val = next_sum - next_seg.query(j,i)
        prev_val = prev_seg.query(j+1, i+1)
      end
      ch_transformation_cost[i][j] = [next_val, prev_val].min
    end
  end

  n = s.size
  dist = 0
  s_chars = s.chars
  t_chars = t.chars

  
  (0...n).each do |idx|
    dist+=ch_transformation_cost[ch_idx_h[s_chars[idx]]][ch_idx_h[t_chars[idx]]]
  end
  dist
end
```
    </CodeGroup>
  </Expandable>
  </Tab>
</Tabs>