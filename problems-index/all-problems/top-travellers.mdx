---
title: "ðŸ§© Top Travellers"
description: '[leetcode link](https://leetcode.com/problems/top-travellers/description/)'
mode: 'wide'
---
<Tabs>
  <Tab title="Question" icon="circle-question" iconType="regular">
    <Card>
      <p>Table: <code>Users</code></p>   +---------------+---------+ | Column Name   | Type    | +---------------+---------+ | id            | int     | | name          | varchar | +---------------+---------+ id is the column with unique values for this table. name is the name of the user.     <p>Table: <code>Rides</code></p>   +---------------+---------+ | Column Name   | Type    | +---------------+---------+ | id            | int     | | user_id       | int     | | distance      | int     | +---------------+---------+ id is the column with unique values for this table. user_id is the id of the user who traveled the distance &quot;distance&quot;.     <p>Write a solution&nbsp;to report the distance traveled by each user.</p>  <p>Return the result table ordered by <code>travelled_distance</code> in <strong>descending order</strong>, if two or more users traveled the same distance, order them by their <code>name</code> in <strong>ascending order</strong>.</p>  <p>The&nbsp;result format is in the following example.</p>   <p><strong class="example">Example 1:</strong></p>   <strong>Input:</strong>  Users table: +------+-----------+ | id   | name      | +------+-----------+ | 1    | Alice     | | 2    | Bob       | | 3    | Alex      | | 4    | Donald    | | 7    | Lee       | | 13   | Jonathan  | | 19   | Elvis     | +------+-----------+ Rides table: +------+----------+----------+ | id   | user_id  | distance | +------+----------+----------+ | 1    | 1        | 120      | | 2    | 2        | 317      | | 3    | 3        | 222      | | 4    | 7        | 100      | | 5    | 13       | 312      | | 6    | 19       | 50       | | 7    | 7        | 120      | | 8    | 19       | 400      | | 9    | 7        | 230      | +------+----------+----------+ <br/> <strong>Output:</strong>  +----------+--------------------+ | name     | travelled_distance | +----------+--------------------+ | Elvis    | 450                | | Lee      | 450                | | Bob      | 317                | | Jonathan | 312                | | Alex     | 222                | | Alice    | 120                | | Donald   | 0                  | +----------+--------------------+ <br/> <strong>Explanation:</strong>  Elvis and Lee traveled 450 miles, Elvis is the top traveler as his name is alphabetically smaller than Lee. Bob, Jonathan, Alex, and Alice have only one ride and we just order them by the total distances of the ride. Donald did not have any rides, the distance traveled by him is 0.  
    </Card>
  </Tab>
  <Tab title="Solution" icon="lightbulb" iconType="regular" >
    <Card>
      No notes for this problem
</Card>
  <Expandable title="code">
    <CodeGroup dropdown>
```postgresql title="Top Travellers" lines
-- Write your PostgreSQL query statement below
select u.name, coalesce(r.t_d, 0) as travelled_distance
from users u
left join ( select user_id, sum(distance) as t_d from rides group by user_id) r on r.user_id = u.id
order by travelled_distance desc, u.name asc

```
    </CodeGroup>
  </Expandable>
  </Tab>
</Tabs>