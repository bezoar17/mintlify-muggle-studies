---
title: 'ðŸ§€ Maximum Total from Optimal Activation Order'
description: '[leetcode link](https://leetcode.com/problems/maximum-total-from-optimal-activation-order/description/)'
mode: 'wide'
---
<Tabs>
  <Tab title="Question" icon="circle-question" iconType="regular">
    <Card>
      <p>You are given two integer arrays <code>value</code> and <code>limit</code>, both of length <code>n</code>.</p>  <p>Initially, all elements are <strong>inactive</strong>. You may activate them in any order.</p>  <ul>  <li>To activate an inactive element at index <code>i</code>, the number of <strong>currently</strong> active elements must be <strong>strictly less</strong> than <code>limit[i]</code>.</li>  <li>When you activate the element at index <code>i</code>, it adds <code>value[i]</code> to the <strong>total</strong> activation value (i.e., the sum of <code>value[i]</code> for all elements that have undergone activation operations).</li>  <li>After each activation, if the number of <strong>currently</strong> active elements becomes <code>x</code>, then <strong>all</strong> elements <code>j</code> with <code>limit[j] &lt;= x</code> become <strong>permanently</strong> inactive, even if they are already active.</li> </ul>  <p>Return the <strong>maximum</strong> <strong>total</strong> you can obtain by choosing the activation order optimally.</p>   <p><strong class="example">Example 1:</strong></p>  <div class="example-block"> <p><strong>Input:</strong> <span class="example-io">value = [3,5,8], limit = [2,1,3]</span></p>  <p><br/> <strong>Output:</strong> <span class="example-io">16</span></p>  <p><br/> <strong>Explanation:</strong></p>  <p>One optimal activation order is:</p>  <table>  <thead>   <tr>    <th align="center" style="border: 1px solid black;">Step</th>    <th align="center" style="border: 1px solid black;">Activated <code>i</code></th>    <th align="center" style="border: 1px solid black;"><code>value[i]</code></th>    <th align="center" style="border: 1px solid black;">Active Before <code>i</code></th>    <th align="center" style="border: 1px solid black;">Active After <code>i</code></th>    <th align="center" style="border: 1px solid black;">Becomes Inactive <code>j</code></th>    <th align="center" style="border: 1px solid black;">Inactive Elements</th>    <th align="center" style="border: 1px solid black;">Total</th>   </tr>  </thead>  <tbody>   <tr>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">5</td>    <td align="center" style="border: 1px solid black;">0</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;"><code>j = 1</code> as <code>limit[1] = 1</code></td>    <td align="center" style="border: 1px solid black;">[1]</td>    <td align="center" style="border: 1px solid black;">5</td>   </tr>   <tr>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">0</td>    <td align="center" style="border: 1px solid black;">3</td>    <td align="center" style="border: 1px solid black;">0</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">-</td>    <td align="center" style="border: 1px solid black;">[1]</td>    <td align="center" style="border: 1px solid black;">8</td>   </tr>   <tr>    <td align="center" style="border: 1px solid black;">3</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">8</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;"><code>j = 0</code> as <code>limit[0] = 2</code></td>    <td align="center" style="border: 1px solid black;">[0, 1]</td>    <td align="center" style="border: 1px solid black;">16</td>   </tr>  </tbody> </table>  <p>Thus, the maximum possible total is 16.</p> </div>  <p><strong class="example">Example 2:</strong></p>  <div class="example-block"> <p><strong>Input:</strong> <span class="example-io">value = [4,2,6], limit = [1,1,1]</span></p>  <p><br/> <strong>Output:</strong> <span class="example-io">6</span></p>  <p><br/> <strong>Explanation:</strong></p>  <p>One optimal activation order is:</p>  <table style="border: 1px solid black;">  <thead>   <tr>    <th align="center" style="border: 1px solid black;">Step</th>    <th align="center" style="border: 1px solid black;">Activated <code>i</code></th>    <th align="center" style="border: 1px solid black;"><code>value[i]</code></th>    <th align="center" style="border: 1px solid black;">Active Before <code>i</code></th>    <th align="center" style="border: 1px solid black;">Active After <code>i</code></th>    <th align="center" style="border: 1px solid black;">Becomes Inactive <code>j</code></th>    <th align="center" style="border: 1px solid black;">Inactive Elements</th>    <th align="center" style="border: 1px solid black;">Total</th>   </tr>  </thead>  <tbody>   <tr>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">6</td>    <td align="center" style="border: 1px solid black;">0</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;"><code>j = 0, 1, 2</code> as <code>limit[j] = 1</code></td>    <td align="center" style="border: 1px solid black;">[0, 1, 2]</td>    <td align="center" style="border: 1px solid black;">6</td>   </tr>  </tbody> </table>  <p>Thus, the maximum possible total is 6.</p> </div>  <p><strong class="example">Example 3:</strong></p>  <div class="example-block"> <p><strong>Input:</strong> <span class="example-io">value = [4,1,5,2], limit = [3,3,2,3]</span></p>  <p><br/> <strong>Output:</strong> <span class="example-io">12</span></p>  <p><br/> <strong>Explanation:</strong></p>  <p>One optimal activation order is:â€‹â€‹â€‹â€‹â€‹â€‹â€‹<strong>â€‹â€‹â€‹â€‹â€‹â€‹â€‹</strong></p>  <table style="border: 1px solid black;">  <thead>   <tr>    <th align="center" style="border: 1px solid black;">Step</th>    <th align="center" style="border: 1px solid black;">Activated <code>i</code></th>    <th align="center" style="border: 1px solid black;"><code>value[i]</code></th>    <th align="center" style="border: 1px solid black;">Active Before <code>i</code></th>    <th align="center" style="border: 1px solid black;">Active After <code>i</code></th>    <th align="center" style="border: 1px solid black;">Becomes Inactive <code>j</code></th>    <th align="center" style="border: 1px solid black;">Inactive Elements</th>    <th align="center" style="border: 1px solid black;">Total</th>   </tr>  </thead>  <tbody>   <tr>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">5</td>    <td align="center" style="border: 1px solid black;">0</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">-</td>    <td align="center" style="border: 1px solid black;">[ ]</td>    <td align="center" style="border: 1px solid black;">5</td>   </tr>   <tr>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">0</td>    <td align="center" style="border: 1px solid black;">4</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;"><code>j = 2</code> as <code>limit[2] = 2</code></td>    <td align="center" style="border: 1px solid black;">[2]</td>    <td align="center" style="border: 1px solid black;">9</td>   </tr>   <tr>    <td align="center" style="border: 1px solid black;">3</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">1</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">-</td>    <td align="center" style="border: 1px solid black;">[2]</td>    <td align="center" style="border: 1px solid black;">10</td>   </tr>   <tr>    <td align="center" style="border: 1px solid black;">4</td>    <td align="center" style="border: 1px solid black;">3</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">2</td>    <td align="center" style="border: 1px solid black;">3</td>    <td align="center" style="border: 1px solid black;"><code>j = 0, 1, 3</code> as <code>limit[j] = 3</code></td>    <td align="center" style="border: 1px solid black;">[0, 1, 2, 3]</td>    <td align="center" style="border: 1px solid black;">12</td>   </tr>  </tbody> </table>  <p>Thus, the maximum possible total is 12.</p> </div>   <p><strong>Constraints:</strong></p>  <ul>  <li><code>1 &lt;= n == value.length == limit.length &lt;= 10<sup>5</sup></code></li>  <li><code>1 &lt;= value[i] &lt;= 10<sup>5</sup></code>â€‹â€‹â€‹â€‹â€‹â€‹â€‹</li>  <li><code>1 &lt;= limit[i] &lt;= n</code></li> </ul> 
    </Card>
  </Tab>
  <Tab title="Solution" icon="lightbulb" iconType="regular" >
    <Card>
      Active count increases from 0 to some x, then resets to 0, then increases again and comes back to 0 again. The x till which active count can increase is basically the limit values. We start from 0 go to a particular limit value by activating elements, then when it resets to 0, all the lower limit values are rendered useless. So, we will go to lowest limit first, then the next, then the next and so on. But with each limit's group, we can choose only till limit or total items whichever is lower, so you would choose the top items from there. We can calculate this for all limit groups separately, and sum it up. 

Actual order of execution would be lowest limit, then next one, then the next one and so on. But for calculation order doesnt matter just sum it up.
    </Card>
  <Expandable title="code">
    <CodeGroup dropdown>
```ruby title="Maximum Total from Optimal Activation Order" lines
# @param {Integer[]} value
# @param {Integer[]} limit
# @return {Integer}
def max_total(value, limit)
  elem_store = Hash.new {|h,k| h[k]=[]}
  limit.zip(value).each { |l, v| elem_store[l] << v }
  elem_store.each.sum { |k,elems| elems.sort.last(k).sum }
end
```
    </CodeGroup>
  </Expandable>
  </Tab>
</Tabs>