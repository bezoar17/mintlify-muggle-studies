---
title: '❗️ Find the Maximum Number of Fruits Collected'
description: '[leetcode link](https://leetcode.com/problems/find-the-maximum-number-of-fruits-collected/description/)'
mode: 'wide'
---
<Tabs>
  <Tab title="Question" icon="circle-question" iconType="regular">
    <Card>
      <p>There is a game dungeon comprised of&nbsp;<code>n x n</code> rooms arranged in a grid.</p>  <p>You are given a 2D array <code>fruits</code> of size <code>n x n</code>, where <code>fruits[i][j]</code> represents the number of fruits in the room <code>(i, j)</code>. Three children will play in the game dungeon, with <strong>initial</strong> positions at the corner rooms <code>(0, 0)</code>, <code>(0, n - 1)</code>, and <code>(n - 1, 0)</code>.</p>  <p>The children will make <strong>exactly</strong> <code>n - 1</code> moves according to the following rules to reach the room <code>(n - 1, n - 1)</code>:</p>  <ul>  <li>The child starting from <code>(0, 0)</code> must move from their current room <code>(i, j)</code> to one of the rooms <code>(i + 1, j + 1)</code>, <code>(i + 1, j)</code>, and <code>(i, j + 1)</code> if the target room exists.</li>  <li>The child starting from <code>(0, n - 1)</code> must move from their current room <code>(i, j)</code> to one of the rooms <code>(i + 1, j - 1)</code>, <code>(i + 1, j)</code>, and <code>(i + 1, j + 1)</code> if the target room exists.</li>  <li>The child starting from <code>(n - 1, 0)</code> must move from their current room <code>(i, j)</code> to one of the rooms <code>(i - 1, j + 1)</code>, <code>(i, j + 1)</code>, and <code>(i + 1, j + 1)</code> if the target room exists.</li> </ul>  <p>When a child enters a room, they will collect all the fruits there. If two or more children enter the same room, only one child will collect the fruits, and the room will be emptied after they leave.</p>  <p>Return the <strong>maximum</strong> number of fruits the children can collect from the dungeon.</p>   <p><strong class="example">Example 1:</strong></p>  <div class="example-block"> <p><strong>Input:</strong> <span class="example-io">fruits = [[1,2,3,4],[5,6,8,7],[9,10,11,12],[13,14,15,16]]</span></p>  <p><br/> <strong>Output:</strong> <span class="example-io">100</span></p>  <p><br/> <strong>Explanation:</strong></p>  <p><img alt="" src="https://assets.leetcode.com/uploads/2025/08/07/clideo_editor_d0b446db9ba448e1a3fcdd0eecdb58d0-ezgifcom-crop.gif" style="width: 250px; height: 210px;" /></p>  <p>In this example:</p>  <ul>  <li>The 1<sup>st</sup> child (green) moves on the path <code>(0,0) -&gt; (1,1) -&gt; (2,2) -&gt; (3, 3)</code>.</li>  <li>The 2<sup>nd</sup> child (red) moves on the path <code>(0,3) -&gt; (1,2) -&gt; (2,3) -&gt; (3, 3)</code>.</li>  <li>The 3<sup>rd</sup> child (blue) moves on the path <code>(3,0) -&gt; (3,1) -&gt; (3,2) -&gt; (3, 3)</code>.</li> </ul>  <p>In total they collect <code>1 + 6 + 11 + 16 + 4 + 8 + 12 + 13 + 14 + 15 = 100</code> fruits.</p> </div>  <p><strong class="example">Example 2:</strong></p>  <div class="example-block"> <p><strong>Input:</strong> <span class="example-io">fruits = [[1,1],[1,1]]</span></p>  <p><br/> <strong>Output:</strong> <span class="example-io">4</span></p>  <p><br/> <strong>Explanation:</strong></p>  <p>In this example:</p>  <ul>  <li>The 1<sup>st</sup> child moves on the path <code>(0,0) -&gt; (1,1)</code>.</li>  <li>The 2<sup>nd</sup> child moves on the path <code>(0,1) -&gt; (1,1)</code>.</li>  <li>The 3<sup>rd</sup> child moves on the path <code>(1,0) -&gt; (1,1)</code>.</li> </ul>  <p>In total they collect <code>1 + 1 + 1 + 1 = 4</code> fruits.</p> </div>   <p><strong>Constraints:</strong></p>  <ul>  <li><code>2 &lt;= n == fruits.length == fruits[i].length &lt;= 1000</code></li>  <li><code>0 &lt;= fruits[i][j] &lt;= 1000</code></li> </ul> 
    </Card>
  </Tab>
  <Tab title="Solution" icon="lightbulb" iconType="regular" >
    <Card>
      * child 1 has only 1 path, due to its directions, starting point and no. of moves allowed, i.e the diagonal
*  essentially, c1 will take all from this diagonal, and now these values are 0. 
* as that diagonal will have 0 values, child 2 and 3, cant reach the top_left - down_right diagonal, doesnt make sense, because once you are at diagonal, thats the only path, and now has only 0s, maybe if we have negative values, we can try reaching diagonal for 0 value and avoid negatives.
* And for child 2 & 3, cells with i+j &lt; n-1 are unreachable(if they reach this area, they wont make end in time).
* child 2 and child 3 have different triangular areas they can collect from, calculate these separately and sum it up
    </Card>
  <Expandable title="code">
    <CodeGroup dropdown>
```ruby title="Find the Maximum Number of Fruits Collected" lines
# @param {Integer[][]} fruits
# @return {Integer}
def max_collected_fruits(fruits)
  n = fruits.size
  c1_sum = (0...n).map { |i| fruits[i][i] }.sum
  
  # update values after c1's path, and set unreachable(will become easier to calculate for c2, c3)
  (0...n).each do |i|
    (0...n).each do |j|
      fruits[i][i] = 0 if i==j
      fruits[i][j] = -Float::INFINITY if i+j < n-1
    end
  end

  # calculate c3 max from 
  (1...n).each do |j|
    min_i = [n-1-j, j+1].max # topmost reachable row for this column for c3
    (min_i...n).each do |i|
      # next if j>=i
      fruits[i][j] += [
        fruits[i-1][j-1],
        fruits[i][j-1],
        ((i+1) < n ? fruits[i+1][j-1] : -Float::INFINITY)
      ].max
    end
  end

  c3_sum = fruits[n-1][n-2]
  # diagonal has c3's calculated values, so reset it again before c2's calculation
  (0...n).each { |i| fruits[i][i]=-Float::INFINITY }; fruits[n-1][n-1]=0

  
  # calculate c2 max
  (1...n).each do |i|
    min_j = [n-1-i, i+1].max # leftmost reachable column for this row for c2
    (min_j...n).each do |j|
      # next if i>=j
      fruits[i][j] += [
        fruits[i-1][j-1],
        fruits[i-1][j],
        ((j+1) < n ? fruits[i-1][j+1] : -Float::INFINITY)
      ].max
    end
  end

  c2_sum = fruits[n-2][n-1]

  c1_sum + c2_sum + c3_sum
end
```
    </CodeGroup>
  </Expandable>
  </Tab>
</Tabs>